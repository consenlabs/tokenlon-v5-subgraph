type FillOrder @entity {
  id: ID!
  from: Bytes!
  to: Bytes!
  txNumber: BigInt! # uint256
  source: String! # string
  blockHash: String!
  transactionHash: String!
  executeTxHash: Bytes!
  orderHash: Bytes! # bytes32
  userAddr: Bytes! # bytes32
  takerAssetAddr: Bytes! # bytes32
  takerAssetAmount: BigInt! # uint256
  makerAddr: Bytes! # bytes32
  makerAssetAddr: Bytes! # bytes32
  makerAssetAmount: BigInt! # uint256
  receiverAddr: Bytes! # bytes32
  settleAmount: BigInt! # uint256
  feeFactor: Int! # uin16 < uint32
  blockNumber: BigInt! # block number
  logIndex: BigInt! # transaction index
  eventAddr: Bytes! # bytes32
  gasPrice: BigInt! # uint256
  timestamp: Int!
}

type Swapped @entity {
  id: ID!
  from: Bytes!
  to: Bytes!
  txNumber: BigInt! # uint256
  source: String! # string
  blockHash: String!
  transactionHash: String!
  executeTxHash: Bytes!
  userAddr: Bytes! # bytes32
  takerAssetAddr: Bytes! # bytes32
  takerAssetAmount: BigInt! # uint256
  makerAddr: Bytes! # bytes32
  makerAssetAddr: Bytes! # bytes32
  makerAssetAmount: BigInt! # uint256
  receiverAddr: Bytes! # bytes32
  settleAmount: BigInt! # uint256
  receivedAmount: BigInt! # uint256
  feeFactor: Int! # uin16 < uint32
  subsidyFactor: Int! # uin16 < uint32
  blockNumber: BigInt! # block number
  logIndex: BigInt! # transaction index
  eventAddr: Bytes! # bytes32
  gasPrice: BigInt! # uint256
  timestamp: Int!
  salt: BigInt! # uint256
  deadline: BigInt! # uint256
  path: [Bytes!]
}

type SwappedTotal @entity {
  id: ID!
  total: BigInt!
}

type FillOrderTotal @entity {
  id: ID!
  total: BigInt!
}

type SubsidizedSwapped @entity {
  id: ID!
  from: Bytes!
  to: Bytes!
  source: String! # string
  blockHash: String!
  transactionHash: String!
  executeTxHash: Bytes!
  userAddr: Bytes! # bytes32
  takerAssetAddr: Bytes! # bytes32
  takerAssetAmount: BigInt! # uint256
  makerAddr: Bytes! # bytes32
  makerAssetAddr: Bytes! # bytes32
  makerAssetAmount: BigInt! # uint256
  receiverAddr: Bytes! # bytes32
  settleAmount: BigInt! # uint256
  receivedAmount: BigInt! # uint256
  feeFactor: Int! # uin16 < uint32
  subsidyFactor: Int! # uin16 < uint32
  blockNumber: BigInt! # block number
  logIndex: BigInt! # transaction index
  eventAddr: Bytes! # bytes32
  gasPrice: BigInt! # uint256
  timestamp: Int!
  salt: BigInt! # uint256
  deadline: BigInt! # uint256
  path: [Bytes!]
}

# For LimitOrder contract
type LimitOrderFilledByProtocol @entity(immutable: true) {
  id: ID!
  orderHash: Bytes! # bytes32
  maker: Bytes! # address
  taker: Bytes! # address
  allowFillHash: Bytes! # bytes32
  relayer: Bytes! # address
  profitRecipient: Bytes! # address
  fillReceiptMakerToken: Bytes! # address
  fillReceiptTakerToken: Bytes! # address
  fillReceiptMakerTokenFilledAmount: BigInt! # uint256
  fillReceiptTakerTokenFilledAmount: BigInt! # uint256
  fillReceiptRemainingAmount: BigInt! # uint256
  fillReceiptMakerTokenFee: BigInt! # uint256
  fillReceiptTakerTokenFee: BigInt! # uint256
  takerTokenProfit: BigInt! # uint256
  takerTokenProfitFee: BigInt! # uint256
  takerTokenProfitBackToMaker: BigInt! # uint256
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

type LimitOrderFilledByTrader @entity(immutable: true) {
  id: ID!
  orderHash: Bytes! # bytes32
  maker: Bytes! # address
  taker: Bytes! # address
  allowFillHash: Bytes! # bytes32
  recipient: Bytes! # address
  fillReceiptMakerToken: Bytes! # address
  fillReceiptTakerToken: Bytes! # address
  fillReceiptMakerTokenFilledAmount: BigInt! # uint256
  fillReceiptTakerTokenFilledAmount: BigInt! # uint256
  fillReceiptRemainingAmount: BigInt! # uint256
  fillReceiptMakerTokenFee: BigInt! # uint256
  fillReceiptTakerTokenFee: BigInt! # uint256
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

type OrderCancelled @entity(immutable: true) {
  id: ID!
  orderHash: Bytes! # bytes32
  maker: Bytes! # address
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

enum OrderStatus {
  Normal
  Cancelled
  FullyFilled
}

enum LimitOrderTypes {
  ByProtocol
  ByTrader
}

type Order @entity(immutable: false) {
  id: ID! # orderHash
  limitOrderFilledId: [String!]! # One-to-many relationship
  orderStatus: OrderStatus!
  maker: Bytes! # address
  makerToken: Bytes! # address
  takerToken: Bytes! # address
  firstFilledTime: BigInt!
  lastFilledTime: BigInt!
  cancelledTime: BigInt!
}

type LimitOrder @entity(immutable: true) {
  id: ID!
  orderId: String! # Order! # orderHash
  limitOrderType: LimitOrderTypes!
  maker: Bytes! # address
  taker: Bytes! # address
  makerToken: Bytes! # address
  takerToken: Bytes! # address
  allowFillHash: Bytes! # bytes32
  makerTokenFilledAmount: BigInt! # uint256
  takerTokenFilledAmount: BigInt! # uint256
  remainingAmount: BigInt! # uint256
  makerTokenFee: BigInt! # uint256
  takerTokenFee: BigInt! # uint256
  recipient: Bytes! # address # Only used by LimitOrderFilledByTrader event
  relayer: Bytes! # address # Only used by LimitOrderFilledByProtocol event
  profitRecipient: Bytes! # address # Only used by LimitOrderFilledByProtocol event
  takerTokenProfit: BigInt! # uint256 # Only used by LimitOrderFilledByProtocol event
  takerTokenProfitFee: BigInt! # uint256 # Only used by LimitOrderFilledByProtocol event
  takerTokenProfitBackToMaker: BigInt! # uint256 # Only used by LimitOrderFilledByProtocol event
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

# Shared entities
type TradedToken @entity {
  id: ID!
  address: Bytes! # bytes32
  decimals: Int!
  startDate: Int!
  symbol: String!
  name: String!
}

type User @entity {
  id: ID!
  tradeCount: Int!
  lastSeen: Int!
  firstSeen: Int!
  firstTx: String!
  firstBlock: BigInt!
}
